blueprint_name: vpc-network-blueprint

vars:
  deployment_name: vpc-network
  project_id: upbeat-polygon-242617
  region: us-central1

deployment_groups:
- group: primary
  modules:
    - id: network
      source: modules/network/vpc
      settings:
        project_id: $(vars.project_id)
        region: $(vars.region)
        network_name: slurm-gcp-net
        network_description: VPC network for the HPC cluster
        subnetwork_name: slurm-gcp-primary-subnet

        subnetworks:
          - subnet_name: slurm-gcp-primary-subnet
            subnet_region: $(vars.region)
            subnet_ip: 10.0.0.0/24
            subnet_private_access: true

        firewall_rules:
          - name: ssh-my-machine
            description: Allows TCP connections from any source to any instance on the network using port 22.
            direction: INGRESS
            range: [0.0.0.0/0]
            allow:
              - protocol: tcp
                ports: [22]
